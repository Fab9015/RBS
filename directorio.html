<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Directorio de Contactos</title>
  <style>
    :root {
      --color-bg: #fdfaf5;
      --color-title: #5c4033;
      --color-accent: #a1b27a;
      --color-white: #fefefe;
      --color-text: #5c4033;
      --color-border: #e6e2dc;
    }
    body {
      font-family: 'Lato', sans-serif;
      background: var(--color-bg);
      margin: 0;
      padding: 0;
      color: var(--color-text);
    }
    h1,h2,h3 { font-family: 'Montserrat', sans-serif; }
    h2,h3,h4 { color: var(--color-title); }
    header {
      text-align: center;
      padding: 2em 1em;
    }
    .container {
      max-width: 1000px;
      margin: auto;
      padding: 1em;
    }

    /* Contact card estilo credencial */
    .contact-card {
      display: flex;
      align-items: center;
      background: var(--color-bg);
      border: 1px solid var(--color-border);
      border-radius: 8px;
      padding: 1em;
      margin-bottom: 1em;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
    }
    .contact-card img {
      width: 100px;
      height: 100px;
      object-fit: contain;
      margin-right: 1em;
    }
    .contact-info h3 {
      margin: 0;
      color: var(--color-title);
    }
    .contact-line {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin: 4px 0;
    }
    .whatsapp-btn {
      background: var(--color-accent);
      color: white;
      padding: 4px 8px;
      border-radius: 6px;
      text-decoration: none;
      font-size: 12px;
      margin-left: 8px;
    }
    .whatsapp-btn:hover {
      background: #8fa76a;
    }

    /* Tabs */
    .tabs {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      margin: 1em 0;
    }
    .tabs button {
      background: var(--color-accent);
      color: var(--color-white);
      border: none;
      padding: 8px 16px;
      margin: 4px;
      border-radius: 6px;
      cursor: pointer;
    }
    .tabs button:hover {
      background: #8fa76a;
    }

    /* Dropdown */
    .filter {
      text-align: center;
      margin: 1em 0;
    }
    select {
      padding: 6px;
      border-radius: 6px;
      border: 1px solid var(--color-border);
    }

    /* Paginaci√≥n */
    .pagination {
      display: flex;
      justify-content: center;
      align-items: center;
      margin: 1em 0;
    }
    .pagination button {
      background: var(--color-accent);
      color: var(--color-white);
      border: none;
      padding: 6px 10px;
      margin: 0 4px;
      border-radius: 4px;
      cursor: pointer;
    }
    .pagination button:hover {
      background: #8fa76a;
    }
    .pagination span {
      margin: 0 4px;
      font-weight: bold;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .contact-card {
        flex-direction: column;
        align-items: flex-start;
      }
      .contact-card img {
        margin-bottom: 0.5em;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>Directorio de Contactos del Condominio</h1>
    <p>Encuentra tel√©fonos y correos de trabajadores recomendados y contactos importantes.</p>
  </header>

  <div class="container">
    <!-- Contactos relevantes -->
    <h2>Contactos importantes</h2>
    <div id="relevantes"></div>

    <!-- Tabs -->
    <div class="tabs" id="tabs"></div>

    <!-- Filtro por categor√≠a -->
    <div class="filter">
      <label for="categoria">Selecciona categor√≠a: </label>
      <select id="categoria">
        <option value="todos">Todos</option>
      </select>
    </div>

    <!-- Lista de trabajadores -->
    <div id="lista"></div>

    <!-- Paginaci√≥n -->
    <div class="pagination" id="paginacion"></div>

    <!-- Filtro de √≠tems por p√°gina -->
    <div class="filter" style="text-align:left;">
      <label for="porPagina">Elementos por p√°gina: </label>
      <select id="porPagina">
        <option value="10">10</option>
        <option value="15">15</option>
      </select>
    </div>
  </div>
    <script>
    let datos = {};
    let paginaActual = 1;
    let porPagina = 10;

    fetch('directorio.json')
      .then(r => r.json())
      .then(json => {
        datos = json;
        renderRelevantes();
        renderTabs();
        renderCategorias();
        renderLista();
        renderPaginacion();
      });

    function renderRelevantes() {
      const cont = document.getElementById('relevantes');
      cont.innerHTML = "";
      datos.relevantes.forEach((c, i) => {
        const icono = i === 0 ? "img/admin.png" : i === 1 ? "img/vigilancia.png" : "img/trabajador.png";
        const whatsapp = `https://wa.me/52${c.telefono}?text=Hola,%20me%20comunico%20desde%20el%20directorio%20del%20condominio`;
        const correo = c.correo ? `<div class="contact-line"><strong>Email:</strong> <a href="mailto:${c.correo}">${c.correo}</a></div>` : "";
        cont.innerHTML += `
          <div class="contact-card">
            <img src="${icono}" alt="${c.nombre}">
            <div class="contact-info">
              <h3>${c.nombre}</h3>
              <div class="contact-line">
                <strong>Tel:</strong> <a href="tel:${c.telefono}">${c.telefono}</a>
                <a class="whatsapp-btn" href="${whatsapp}" target="_blank">üí¨ WhatsApp</a>
              </div>
              ${correo}
            </div>
          </div>`;
      });
    }

    function renderTabs() {
      const cont = document.getElementById('tabs');
      cont.innerHTML = "";
      datos.busquedasRelevantes.forEach(b => {
        if(b.activo){
          cont.innerHTML += `<button onclick="filtrar('${b.categoria}')">${b.categoria}</button>`;
        }
      });
    }

    function renderCategorias() {
      const sel = document.getElementById('categoria');
      datos.categorias.forEach(cat => {
        const opt = document.createElement("option");
        opt.value = cat;
        opt.textContent = cat;
        sel.appendChild(opt);
      });
    }

    function filtrar(cat) {
      document.getElementById('categoria').value = cat;
      paginaActual = 1;
      renderLista();
      renderPaginacion();
    }

    function renderLista() {
      const lista = document.getElementById('lista');
      lista.innerHTML = "";
      const categoria = document.getElementById('categoria').value;
      let filtrados = datos.trabajadores;
      if(categoria !== "todos"){
        filtrados = filtrados.filter(t => t.categoria === categoria);
      }
      const inicio = (paginaActual - 1) * porPagina;
      const fin = inicio + porPagina;
      const pagina = filtrados.slice(inicio, fin);

      pagina.forEach(t => {
        const whatsappLink = `https://wa.me/52${t.telefono}?text=Hola,%20me%20comunico%20desde%20el%20directorio%20del%20condominio`;
        const correoLink = t.correo ? `<div class="contact-line"><strong>Email:</strong> <a href="mailto:${t.correo}">${t.correo}</a></div>` : "";
        lista.innerHTML += `
          <div class="contact-card">
            <img src="img/trabajador.png" alt="${t.categoria}">
            <div class="contact-info">
              <h3>${t.nombre}</h3>
              <div class="contact-line">
                <strong>Tel:</strong> <a href="tel:${t.telefono}">${t.telefono}</a>
                <a class="whatsapp-btn" href="${whatsappLink}" target="_blank">üí¨ WhatsApp</a>
              </div>
              ${correoLink}
              <div class="contact-line">
                <strong>Categor√≠a:</strong> ${t.categoria}
              </div>
            </div>
          </div>`;
      });
    }

    function renderPaginacion() {
      const cont = document.getElementById('paginacion');
      cont.innerHTML = "";
      const categoria = document.getElementById('categoria').value;
      let filtrados = datos.trabajadores;
      if(categoria !== "todos"){
        filtrados = filtrados.filter(t => t.categoria === categoria);
      }
      const totalPaginas = Math.ceil(filtrados.length / porPagina);

      if(totalPaginas <= 1) return;

      cont.innerHTML += `<button onclick="cambiarPagina(${paginaActual-1})" ${paginaActual===1?"disabled":""}>&laquo;</button>`;
      for(let i=1; i<=totalPaginas; i++){
        cont.innerHTML += `<button onclick="cambiarPagina(${i})" ${i===paginaActual?"style='background:var(--color-title);color:white;'":""}>${i}</button>`;
      }
      cont.innerHTML += `<button onclick="cambiarPagina(${paginaActual+1})" ${paginaActual===totalPaginas?"disabled":""}>&raquo;</button>`;
    }

    function cambiarPagina(num) {
      const categoria = document.getElementById('categoria').value;
      let filtrados = datos.trabajadores;
      if(categoria !== "todos"){
        filtrados = filtrados.filter(t => t.categoria === categoria);
      }
      const totalPaginas = Math.ceil(filtrados.length / porPagina);
      if(num < 1 || num > totalPaginas) return;
      paginaActual = num;
      renderLista();
      renderPaginacion();
    }

    document.getElementById('porPagina').addEventListener('change', e => {
      porPagina = parseInt(e.target.value);
      paginaActual = 1;
      renderLista();
      renderPaginacion();
    });
  </script>
</body>
</html>
